# Regular expression to match cve patch info
# rpm列表
# platform:
#   - ghostscript
# 匹配cve补丁信息的正则表达式
regex:
  # A tag that matches the type of content, currently only "commit" "pr" "issue" is supported
  # 匹配内容的类型的标签，当前只支持 "commit"/"pr"/"issue"
  - label: commit
    # Regular expressions that match specific types of content, you can set multiple matching rules
    # 匹配特定类型内容的正则表达式，可以设置多个匹配规则
    regular:
      - http[s]?://(?:[-\w.\/;?\~?])+(?:/rev|/ci|/commit[s]?|/linus|/qtbase/\+|/c|/revision)/(?:\?id=)?[0-9a-z-]{1,40}
      - /\?p=ghostpdl.git;a=commitdiff;h=[a-z0-9]{40};?(?:hp=[0-9a-z;=]{40})?
      - http[s]?://[\w.\/\+]+(?:patch_to_fix_[0-9]{0,8}|security/CVE-[0-9]{4}-[0-9]{1,5}-[a-z]{0,}.txt)
  - label: pr
    regular:
      - http[s]?://(?:[-\w.\/;?])+(?:pull[s]?|merge_requests)/[1-9][0-9]*
  - label: issue
    regular:
      - http[s]?://(?:[-\w.\/;?])+issue[s]?/[0-9A-Z]+

excludes:
  - https://discourse.ubuntu.com/c/ubuntu-pro

specialrpm:
  - name: strongswan
    url: https://download.strongswan.org/security
    patch_url: https://download.strongswan.org/security/{}/
    request: false
  - name: log4j12
    url: https://sources.debian.org/src/apache-log4j1.2
    patch_url: https://sources.debian.org/src/apache-log4j1.2/1.2.17-11/debian/patches/{}.patch/
    request: false
    
# Platforms to find bug fixes for cve, such as Debian, Bugzilla, Nvd, etc.
# 查找cve漏洞修复的平台，例如 Debian、Bugzilla、Nvd等
platform:
  # Platform name (required)
  # 平台的名称(必配项)
  # - name: Cnnvd
  #   # The request address for finding cve details, "{cve num}" is a placeholder for string replacement in python (required)
  #   # 查找cve详情信息的请求地址，“{cve_num}”是python中字符串替换的占位符(必配项)
  #   url: http://www.cnnvd.org.cn/web/vulnerability/queryLds.tag?qcvCnnvdid={cve_num}
  #   # The method of sending the request, the default is get request, and it can also be specified as post request.
  #   # When the request method is get, it can not be configured here.
  #   # 发送请求的方式，默认为get请求，还可以指定为post请求，当请求方式为get时，此处可不配置
  #   method: get
  #   # If the request method is post and there is a request body, the body is required and must be in json format.
  #   # When the request method is get, it can be omitted here.
  #   # 若请求方式为post且存在请求体时，body为必填项，且必须为json格式，当请求方式为get时，此处可不配置
  #   body:
  #   # The way to parse the response body, currently only "text" or "json" is supported (required)
  #   # 解析响应体的方式，当前只支持“text”或“json”(必配项)
  #   format: text
  #   # When the request cannot directly obtain the cve information (multiple jumps according to the specific link in
  #   # the page), you can specify the method of page jump to obtain further information
  #   # 当请求无法直接获取cve信息时（根据页面中特定链接多次跳转），可以指定页面跳转的方式来获取进一步的信息
  #   redirect:
  #     # The prefix of the jump address, generally the domain name of the jump page, if the jump address matched by
  #     # the regular expression has a complete domain name + path, this configuration item can be left blank
  #     # 跳转地址的前缀，一般情况下为跳转页面的域名，如果正则表达式匹配到的跳转地址中有完整的域名+路径，此配置项可以不填写
  #     - prefix: http://www.cnnvd.org.cn
  #       # The regular expression that matches the page jump address, if it matches multiple values, get the last match
  #       # 匹配页面跳转地址的正则表达式，如果匹配多个值，则获取最后一个匹配项
  #       regex: /web/xxk/ldxqById\.tag\?CNNVD=CNNVD[0-9-]+
  #       # The method of sending the request, the default is get request, and it can also be specified as post request.
  #       # When the request is get, it can not be configured here.
  #       # 送请求的方法，默认为get请求，还可以指定为post请求，当请求为get时，此处可不配置
  #       method: get
  #       # If the request method is post and there is a request body, the body is required and must be in json format
  #       # 若请求方式为post且存在请求体时，body为必填项，且必须为json格式
  #       body:
  - name: opencve
    url: https://www.opencve.io/cve/{cve_num}
    format: text
    
  # - name: Debian
  #   url: https://security-tracker.debian.org/tracker/{cve_num}
  #   method: get
  #   format: text
  #   redirect:
  #     - prefix: https://bugs.launchpad.net
  #       regex: /mailman/\+bug/[0-9]{0,8}
  #       method: get
  #       body:
  #     - prefix: https://community.otrs.com
  #       regex: /security-advisory-[0-9]{4}-[0-9]{2}
  #       method: get
  #       body:
  #     - prefix: https://git.ghostscript.com
  #       regex: /\?p=ghostpdl.git;a=(?:commit|commitdiff);h=[a-z0-9]{40};?(?:hp=[0-9a-z;=]{40})?
  #       method: get
  #       body:
      
      
  - name: Ubuntu
    url: https://ubuntu.com/security/{cve_num}
    format: text

  - name: Bugzilla
    url: https://bugzilla.redhat.com/rest/bug/{cve_num}/comment
    format: json

  - name: Nvd
    url: https://nvd.nist.gov/vuln/detail/{cve_num}
    format: text



# Private token for api access, currently only supports "gitee" "github" "gitlab"
# api访问时的私人令牌，当前只支持"gitee"/"github"/"gitlab"
authentication:
  # api name, this value cannot be changed
  # api名称，此值不可更改
  - name: gitee
    # A private token for accessing the api, which can be manually obtained and changed later
    # 访问api的私人令牌，可以手动获取后更改
    token: 19e89f595618a9a6b9a6767e0ec07bc1
  - name: github
    token: 
  - name: gitlab
    token: glpat-Zqq65Tgn89oK8EQm7iVi

# 补丁包下载配置项
download:
  # 补丁包下载路径的调整，分为（REPLACE、APPEND）两种方式，分别对应了补丁路径的替换和拼接
  - action: REPLACE
    # 匹配url的正则表达式，符合特定规则的url进行特定值的替换（必填项）
    regex: http[s]?://(?:[-\w.\/;=&?])+a=commit(?:[\w;&?])+h=[0-9a-z]{8,40}
    # 替换的规则，第一个值为需要替换的内容，第二个值为替换的目标内容，如果不传递默认为（commit,patch）进行替换操作（可选配置项）
    target:
      - commit
      - patch
  - action: REPLACE
    regex: http[s]?://(?:[-\w.\/;?])+/commit[s]?/\?id=[0-9a-z]{8,40}
    target:
      - commit
      - patch
  - action: APPEND
    # 匹配url的正则表达式，符合特定规则的url进行特定值的拼接（必填项）
    regex: http[s]?://(?:[-\w.\/;?])+/commit[s]?/[0-9a-z]{8,40}
    # 拼接的规则，在url地址的末尾需要拼接的内容，如果不传递默认拼接“.patch”(可选配置项)
    target:
      - .patch
