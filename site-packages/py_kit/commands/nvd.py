# -*- coding: utf-8 -*-

from cve_ease.core import Nvd
from cve_ease.sql import database
from .base import BaseCommand
import logging

logger = logging.getLogger('cve-ease')

class NvdCommand(BaseCommand):
    """nvd"""
    @staticmethod
    def register(subparsers):
        NvdCommand.parser = subparsers.add_parser('nvd', help='NVD info')
        NvdCommand.parser.add_argument('-f', '--fetch', dest='fetch', action='store_true', default=False,
                        help='fetch nvd cache')
        NvdCommand.parser.add_argument('-l', '--list', dest='list', action='store_true', default=False,
                        help='list all nvd info')
        NvdCommand.parser.add_argument('-s', '--statistic', dest='stat', action='store_true', default=False,
                        help='get nvd data statistics')
        NvdCommand.parser.add_argument('-c', '--check', dest='check', action='store_true', default=False,
                        help='check repodata cve from nvd')
        NvdCommand.parser.add_argument('-v', '--verbose', dest='verbose', action='store_true', default=False,
                        help='show verbose output')

    def handle(self, options):
        """[info] NVD info"""

        nvd = Nvd()
        if options.fetch:
            nvd.nvd_makecahe()
        elif options.stat:
            nvd.nvd_stat()
        elif options.list:
            nvd.nvd_list()
        elif options.check:
            nvd.nvd_check()
        else:
            NvdCommand.parser.print_help()

