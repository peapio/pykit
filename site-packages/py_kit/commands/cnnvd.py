# -*- coding: utf-8 -*-


import logging
import asyncio

from cve_ease.core import Cnnvd
from .base import BaseCommand

logger = logging.getLogger('cve-ease')


class CnnvdCommand(BaseCommand):
    """cnnvd"""

    parser = None
    @staticmethod
    def register(subparsers):
        CnnvdCommand.parser = subparsers.add_parser('cnnvd', help='official CNNVD info')
        CnnvdCommand.parser.add_argument('-m', '--makecache', dest='makecache', action='store_true', default=False,
                        help='get cnnvd cache')
        CnnvdCommand.parser.add_argument('-l', '--list', dest='list', action='store_true', default=False,
                        help='list all cnnvd info')
        CnnvdCommand.parser.add_argument('-s', '--statistic', dest='stat', action='store_true', default=False,
                        help='get cnnvd info statistics')
        CnnvdCommand.parser.add_argument('-v', '--verbose', dest='verbose', action='store_true', default=False,
                        help='show verbose output')
    def handle(self, options):
        """[info] official CNNVD info"""

        cnnvd = Cnnvd()
        if options.makecache:
            asyncio.run(cnnvd.cnnvd_makecache())
        elif options.stat:
            cnnvd.cnnvd_stat()
        elif options.list:
            cnnvd.cnnvd_listall()
        else:
            CnnvdCommand.parser.print_help()
