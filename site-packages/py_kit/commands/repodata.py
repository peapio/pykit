# -*- coding: utf-8 -*-


import logging

from .base import BaseCommand
from cve_ease.core import RepoData

logger = logging.getLogger('cve-ease')


class RepodataCommand(BaseCommand):
    """repodata"""
    parser = None

    @staticmethod
    def register(subparsers):
        RepodataCommand.parser = subparsers.add_parser('repodata', help='repodata cache and statistics')
        RepodataCommand.parser.add_argument('-f', '--fetch', dest='fetch', action='store_true', default=False,
                        help='cache repodata to database')
        RepodataCommand.parser.add_argument('-s', '--statistics', dest='stat', action='store_true', default=False,
                        help='get total rpm statistics')
        RepodataCommand.parser.add_argument('-l', '--list', dest='list', action='store_true', default=False,
                        help='list all srpm')
        RepodataCommand.parser.add_argument('-v', '--verbose', dest='verbose', action='store', default=False,
                        help='show verbose output')
    

    def handle(self, options):
        """[basic] Yum repodata tool"""

        repodata = RepoData()

        if options.fetch:
            repodata.repodata_makecache()
        elif options.list:
            repodata.repodata_listall()
        elif options.stat:
            repodata.repodata_statistics()
        else:
            RepodataCommand.parser.print_help()